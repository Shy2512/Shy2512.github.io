<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <!-- 引入 LeanCloud SDK -->
    <script src="https://cdn.jsdelivr.net/npm/leancloud-storage@4.13.0/dist/av-min.js"></script>
    <script>
      // 初始化（替换为你的 App ID、App Key、服务器地址）
      AV.init({
        appId: "2NKkhrjq5fASWO7uUBEdUmhx-gzGzoHsz",  // 例如："xxx1234567890abcdef"
        appKey: "f0bSP44t9btEynsOfqGZBzvV", // 例如："xxx1234567890abcdef"
        serverURL: "https://2nkkhrjq.lc-cn-n1-shared.com" // 例如："https://abcdef.leancloud.cn"
      });
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文章详情</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Poppins", sans-serif;
        }
        
        body {
            min-height: 100vh;
            padding: 30px;
            background-image: url('https://cdn.luogu.com.cn/upload/image_hosting/lz40zqee.png'); /* 紫色背景图 */
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed; /* 新增：固定背景图，避免滚动时出现空白 */
            margin: 0; /* 确保body没有默认外边距 */
        }

        /* 文章详情卡片 */
        .article-card {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.85);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            position: relative; /* 用于定位编辑按钮 */
        }

        /* 编辑按钮（右上角） */
        .edit-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: #1a365d; /* 蓝色按钮 */
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 15px;
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .edit-btn:hover {
            background-color: #2c5282;
        }

        /* 文章标题 */
        .article-title {
            font-size: 1.8em;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        /* 文章正文 */
        .article-content {
            color: #555;
            line-height: 1.8;
            font-size: 1.05em;
            white-space: pre-wrap; /* 保留换行和空格 */
            min-height: 300px; /* 确保内容区有足够高度 */
        }

        /* 返回按钮 */
        .back-btn {
            margin-top: 30px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            background-color: #ddd;
            color: #333;
            border: none;
            border-radius: 8px;
            padding: 8px 15px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .back-btn:hover {
            background-color: #ccc;
        }
    </style>
</head>
<body>
    <div class="article-card">
        <!-- 右上角编辑按钮 -->
        <button class="edit-btn" id="editBtn">
            <i class="fas fa-edit"></i> 编辑
        </button>

        <!-- 文章标题 -->
        <h1 class="article-title" id="articleTitle">文章标题</h1>

        <!-- 文章正文 -->
        <div class="article-content" id="articleContent">
            文章正文内容将显示在这里...
        </div>

        <!-- 返回首页按钮 -->
        <button class="back-btn" id="backBtn">
            <i class="fas fa-arrow-left"></i> 返回列表
        </button>
    </div>

    <script>
        let currentArticleId = null; // 当前文章ID

        // 页面加载时初始化
        document.addEventListener('DOMContentLoaded', () => {
            // 1. 验证登录状态
            const currentUser = localStorage.getItem('currentUser');
            if (!currentUser) {
                window.location.href = 'login.html';
                return;
            }

            // 2. 获取URL中的文章ID（从首页点击传递过来）
            const urlParams = new URLSearchParams(window.location.search);
            currentArticleId = urlParams.get('id');
            if (!currentArticleId) {
                alert('文章不存在');
                window.location.href = 'home.html';
                return;
            }

            // 3. 加载文章详情
            loadArticleDetail(currentUser);
        });

        // 加载文章详情
        function loadArticleDetail(username) {
            const userArticlesKey = `articles_${username}`;
            const userArticles = JSON.parse(localStorage.getItem(userArticlesKey) || '[]');
            // 查找当前ID对应的文章
            const article = userArticles.find(art => art.id.toString() === currentArticleId);

            if (!article) {
                alert('文章不存在或已被删除');
                window.location.href = 'home.html';
                return;
            }

            // 填充页面内容
            document.getElementById('articleTitle').textContent = article.title;
            document.getElementById('articleContent').textContent = article.content || '（无正文内容）';
        }

        // 编辑按钮：跳转到编辑页（携带文章ID）
        document.getElementById('editBtn').addEventListener('click', () => {
            if (currentArticleId) {
                window.location.href = `editor.html?id=${currentArticleId}`;
            }
        });

        // 返回按钮：回到首页
        document.getElementById('backBtn').addEventListener('click', () => {
            window.location.href = 'home.html';
        });
    </script>
</body>
</html>
